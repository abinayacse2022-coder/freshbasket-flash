{% extends 'base.html' %}
{% block content %}
  <h1>Your Cart</h1>
  {% if items %}
    <table class="cart-table">
      <tr><th>Product</th><th>Price</th><th>Qty</th><th>Subtotal</th><th></th></tr>
      {% for it in items %}
        <tr data-id="{{it.id}}">
          <td class="p-info"><img src="{{it.image}}" alt="{{it.name}}" loading="lazy" onerror="this.onerror=null;this.src='/static/images/placeholder.svg'"> {{it.name}}</td>
          <td>₹{{'%.2f' % it.price}} / kg</td>
          <td>
            <form method="post" action="/cart/update" class="update-form">
              <input type="hidden" name="product_id" value="{{it.id}}">
              <div class="qty-controls">
                <button type="button" class="qty-decrease">-</button>
                <input class="qty" name="qty" type="number" value="{{'%.2f' % it.qty}}" min="0.1" step="0.1">
                <button type="button" class="qty-increase">+</button>
              </div>
              <button type="submit">Update</button>
            </form>
          </td>
          <td>₹{{'%.2f' % it.subtotal}}</td>
          <td>
            <form method="post" action="/cart/update">
              <input type="hidden" name="product_id" value="{{it.id}}">
              <input type="hidden" name="qty" value="0">
              <button type="submit">Remove</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>
    <div class="cart-summary">Total: <strong>₹{{'%.2f' % total}}</strong></div>
    <a href="/checkout" class="btn">Proceed to Checkout</a>
  {% else %}
    <p>Your cart is empty.</p>
  {% endif %}
{% endblock %}
